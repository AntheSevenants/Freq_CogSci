<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.5 Define a function for generating data | Linear Mixed Models in Linguistics and Psychology: A Comprehensive Introduction</title>
  <meta name="description" content="Linear Mixed Models for Linguistics and Psychology: A Comprehensive Introduction" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="5.5 Define a function for generating data | Linear Mixed Models in Linguistics and Psychology: A Comprehensive Introduction" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/vasishth/Freq_CogSci" />
  <meta property="og:image" content="https://github.com/vasishth/Freq_CogSciimages/temporarycover.jpg" />
  <meta property="og:description" content="Linear Mixed Models for Linguistics and Psychology: A Comprehensive Introduction" />
  <meta name="github-repo" content="rstudio/bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.5 Define a function for generating data | Linear Mixed Models in Linguistics and Psychology: A Comprehensive Introduction" />
  
  <meta name="twitter:description" content="Linear Mixed Models for Linguistics and Psychology: A Comprehensive Introduction" />
  <meta name="twitter:image" content="https://github.com/vasishth/Freq_CogSciimages/temporarycover.jpg" />

<meta name="author" content="Shravan Vasishth, Daniel Schad, Audrey BÃ¼rki, Reinhold Kliegl" />


<meta name="date" content="2020-08-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="extract-parameter-estimates.html"/>
<link rel="next" href="repeated-generation-of-data-to-compute-power.html"/>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Linear Mixed Models in Linguistics and Psychology</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>0.1</b> Prerequisites</a></li>
<li class="chapter" data-level="0.2" data-path="how-to-read-this-book.html"><a href="how-to-read-this-book.html"><i class="fa fa-check"></i><b>0.2</b> How to read this book</a></li>
<li class="chapter" data-level="0.3" data-path="online-materials.html"><a href="online-materials.html"><i class="fa fa-check"></i><b>0.3</b> Online materials</a></li>
<li class="chapter" data-level="0.4" data-path="software-needed.html"><a href="software-needed.html"><i class="fa fa-check"></i><b>0.4</b> Software needed</a></li>
<li class="chapter" data-level="0.5" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i><b>0.5</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-authors.html"><a href="about-the-authors.html"><i class="fa fa-check"></i>About the Authors</a></li>
<li class="part"><span><b>I Foundational ideas</b></span></li>
<li class="chapter" data-level="1" data-path="some-important-facts-about-distributions.html"><a href="some-important-facts-about-distributions.html"><i class="fa fa-check"></i><b>1</b> Some important facts about distributions</a><ul>
<li class="chapter" data-level="1.1" data-path="discrete-random-variables-an-example-using-the-binomial-distribution.html"><a href="discrete-random-variables-an-example-using-the-binomial-distribution.html"><i class="fa fa-check"></i><b>1.1</b> Discrete random variables: An example using the Binomial distribution</a><ul>
<li class="chapter" data-level="1.1.1" data-path="discrete-random-variables-an-example-using-the-binomial-distribution.html"><a href="discrete-random-variables-an-example-using-the-binomial-distribution.html#the-mean-and-variance-of-the-binomial-distribution"><i class="fa fa-check"></i><b>1.1.1</b> The mean and variance of the Binomial distribution</a></li>
<li class="chapter" data-level="1.1.2" data-path="discrete-random-variables-an-example-using-the-binomial-distribution.html"><a href="discrete-random-variables-an-example-using-the-binomial-distribution.html#what-information-does-a-probability-distribution-provide"><i class="fa fa-check"></i><b>1.1.2</b> What information does a probability distribution provide?</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="continuous-random-variables-an-example-using-the-normal-distribution.html"><a href="continuous-random-variables-an-example-using-the-normal-distribution.html"><i class="fa fa-check"></i><b>1.2</b> Continuous random variables: An example using the Normal distribution</a></li>
<li class="chapter" data-level="1.3" data-path="bivariatemultivariate-distributions.html"><a href="bivariatemultivariate-distributions.html"><i class="fa fa-check"></i><b>1.3</b> Bivariate/multivariate distributions</a></li>
<li class="chapter" data-level="1.4" data-path="summary-of-useful-r-functions-relating-to-univariate-distributions.html"><a href="summary-of-useful-r-functions-relating-to-univariate-distributions.html"><i class="fa fa-check"></i><b>1.4</b> Summary of useful R functions relating to univariate distributions</a></li>
<li class="chapter" data-level="1.5" data-path="summary-of-random-variable-theory.html"><a href="summary-of-random-variable-theory.html"><i class="fa fa-check"></i><b>1.5</b> *Summary of random variable theory</a></li>
<li class="chapter" data-level="1.6" data-path="further-reading.html"><a href="further-reading.html"><i class="fa fa-check"></i><b>1.6</b> Further reading</a></li>
<li class="chapter" data-level="1.7" data-path="sec-Foundationsexercises.html"><a href="sec-Foundationsexercises.html"><i class="fa fa-check"></i><b>1.7</b> Exercises</a><ul>
<li class="chapter" data-level="1.7.1" data-path="sec-Foundationsexercises.html"><a href="sec-Foundationsexercises.html#sec:Foundationsexercisespnorm"><i class="fa fa-check"></i><b>1.7.1</b> Practice using the <code>pnorm</code> function</a></li>
<li class="chapter" data-level="1.7.2" data-path="sec-Foundationsexercises.html"><a href="sec-Foundationsexercises.html#sec:Foundationsexercisesqnorm"><i class="fa fa-check"></i><b>1.7.2</b> Practice using the <code>qnorm</code> function</a></li>
<li class="chapter" data-level="1.7.3" data-path="sec-Foundationsexercises.html"><a href="sec-Foundationsexercises.html#sec:Foundationsexercisesqt"><i class="fa fa-check"></i><b>1.7.3</b> Practice using <code>qt</code></a></li>
<li class="chapter" data-level="1.7.4" data-path="sec-Foundationsexercises.html"><a href="sec-Foundationsexercises.html#sec:FoundationsexercisesMLE1"><i class="fa fa-check"></i><b>1.7.4</b> Maximum likelihood estimation 1</a></li>
<li class="chapter" data-level="1.7.5" data-path="sec-Foundationsexercises.html"><a href="sec-Foundationsexercises.html#sec:FoundationsexercisesMLE2"><i class="fa fa-check"></i><b>1.7.5</b> Maximum likelihood estimation 2</a></li>
<li class="chapter" data-level="1.7.6" data-path="sec-Foundationsexercises.html"><a href="sec-Foundationsexercises.html#sec:Foundationsexercisesbivar"><i class="fa fa-check"></i><b>1.7.6</b> Generating bivariate data</a></li>
<li class="chapter" data-level="1.7.7" data-path="sec-Foundationsexercises.html"><a href="sec-Foundationsexercises.html#sec:Foundationsexercisesmultivar"><i class="fa fa-check"></i><b>1.7.7</b> Generating multivariate data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="hypothetical-repeated-sampling-and-the-t-test.html"><a href="hypothetical-repeated-sampling-and-the-t-test.html"><i class="fa fa-check"></i><b>2</b> Hypothetical repeated sampling and the t-test</a><ul>
<li class="chapter" data-level="2.1" data-path="the-central-limit-theorem-using-simulation.html"><a href="the-central-limit-theorem-using-simulation.html"><i class="fa fa-check"></i><b>2.1</b> The central limit theorem using simulation</a></li>
<li class="chapter" data-level="2.2" data-path="three-examples-of-the-sampling-distribution.html"><a href="three-examples-of-the-sampling-distribution.html"><i class="fa fa-check"></i><b>2.2</b> Three examples of the sampling distribution</a></li>
<li class="chapter" data-level="2.3" data-path="the-confidence-interval-and-what-its-good-for.html"><a href="the-confidence-interval-and-what-its-good-for.html"><i class="fa fa-check"></i><b>2.3</b> The confidence interval, and what itâs good for</a></li>
<li class="chapter" data-level="2.4" data-path="hypothesis-testing-the-one-sample-t-test.html"><a href="hypothesis-testing-the-one-sample-t-test.html"><i class="fa fa-check"></i><b>2.4</b> Hypothesis testing: The one sample t-test</a><ul>
<li class="chapter" data-level="2.4.1" data-path="hypothesis-testing-the-one-sample-t-test.html"><a href="hypothesis-testing-the-one-sample-t-test.html#the-one-sample-t-test"><i class="fa fa-check"></i><b>2.4.1</b> The one-sample t-test</a></li>
<li class="chapter" data-level="2.4.2" data-path="hypothesis-testing-the-one-sample-t-test.html"><a href="hypothesis-testing-the-one-sample-t-test.html#type-i-ii-error-and-power"><i class="fa fa-check"></i><b>2.4.2</b> Type I, II error, and power</a></li>
<li class="chapter" data-level="2.4.3" data-path="hypothesis-testing-the-one-sample-t-test.html"><a href="hypothesis-testing-the-one-sample-t-test.html#how-to-compute-power-for-the-one-sample-t-test"><i class="fa fa-check"></i><b>2.4.3</b> How to compute power for the one-sample t-test</a></li>
<li class="chapter" data-level="2.4.4" data-path="hypothesis-testing-the-one-sample-t-test.html"><a href="hypothesis-testing-the-one-sample-t-test.html#the-p-value"><i class="fa fa-check"></i><b>2.4.4</b> The p-value</a></li>
<li class="chapter" data-level="2.4.5" data-path="hypothesis-testing-the-one-sample-t-test.html"><a href="hypothesis-testing-the-one-sample-t-test.html#type-m-and-s-error-in-the-face-of-low-power"><i class="fa fa-check"></i><b>2.4.5</b> Type M and S error in the face of low power</a></li>
<li class="chapter" data-level="2.4.6" data-path="hypothesis-testing-the-one-sample-t-test.html"><a href="hypothesis-testing-the-one-sample-t-test.html#searching-for-significance"><i class="fa fa-check"></i><b>2.4.6</b> Searching for significance</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="the-two-sample-t-test-vs-the-paired-t-test.html"><a href="the-two-sample-t-test-vs-the-paired-t-test.html"><i class="fa fa-check"></i><b>2.5</b> The two-sample t-test vs.Â the paired t-test</a><ul>
<li class="chapter" data-level="2.5.1" data-path="the-two-sample-t-test-vs-the-paired-t-test.html"><a href="the-two-sample-t-test-vs-the-paired-t-test.html#common-mistakes-involving-the-t-test"><i class="fa fa-check"></i><b>2.5.1</b> Common mistakes involving the t-test</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="sec-SamplingDistrnexercises.html"><a href="sec-SamplingDistrnexercises.html"><i class="fa fa-check"></i><b>2.6</b> Exercises</a><ul>
<li class="chapter" data-level="2.6.1" data-path="sec-SamplingDistrnexercises.html"><a href="sec-SamplingDistrnexercises.html#sec:SamplingDistrnexercisesPart1"><i class="fa fa-check"></i><b>2.6.1</b> Computing the p-value</a></li>
<li class="chapter" data-level="2.6.2" data-path="sec-SamplingDistrnexercises.html"><a href="sec-SamplingDistrnexercises.html#sec:SamplingDistrnexercisesPart2"><i class="fa fa-check"></i><b>2.6.2</b> Computing the t-value</a></li>
<li class="chapter" data-level="2.6.3" data-path="sec-SamplingDistrnexercises.html"><a href="sec-SamplingDistrnexercises.html#sec:SamplingDistrnexercisesPart3"><i class="fa fa-check"></i><b>2.6.3</b> Type I and II error</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="linear-models-and-linear-mixed-models.html"><a href="linear-models-and-linear-mixed-models.html"><i class="fa fa-check"></i><b>3</b> Linear models and linear mixed models</a><ul>
<li class="chapter" data-level="3.1" data-path="from-the-t-test-to-the-linear-mixed-model.html"><a href="from-the-t-test-to-the-linear-mixed-model.html"><i class="fa fa-check"></i><b>3.1</b> From the t-test to the linear (mixed) model</a></li>
<li class="chapter" data-level="3.2" data-path="sum-coding.html"><a href="sum-coding.html"><i class="fa fa-check"></i><b>3.2</b> Sum coding</a></li>
<li class="chapter" data-level="3.3" data-path="checking-model-assumptions.html"><a href="checking-model-assumptions.html"><i class="fa fa-check"></i><b>3.3</b> Checking model assumptions</a></li>
<li class="chapter" data-level="3.4" data-path="from-the-paired-t-test-to-the-linear-mixed-model.html"><a href="from-the-paired-t-test-to-the-linear-mixed-model.html"><i class="fa fa-check"></i><b>3.4</b> From the paired t-test to the linear mixed model</a></li>
<li class="chapter" data-level="3.5" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html"><i class="fa fa-check"></i><b>3.5</b> Linear mixed models</a><ul>
<li class="chapter" data-level="3.5.1" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#model-type-1-varying-intercepts"><i class="fa fa-check"></i><b>3.5.1</b> Model type 1: Varying intercepts</a></li>
<li class="chapter" data-level="3.5.2" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#the-formal-statement-of-the-varying-intercepts-model"><i class="fa fa-check"></i><b>3.5.2</b> The formal statement of the varying intercepts model</a></li>
<li class="chapter" data-level="3.5.3" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#model-type-2-varying-intercepts-and-slopes-without-a-correlation"><i class="fa fa-check"></i><b>3.5.3</b> Model type 2: Varying intercepts and slopes, without a correlation</a></li>
<li class="chapter" data-level="3.5.4" data-path="linear-mixed-models.html"><a href="linear-mixed-models.html#model-type-3-varying-intercepts-and-varying-slopes-with-correlation"><i class="fa fa-check"></i><b>3.5.4</b> Model type 3: Varying intercepts and varying slopes, with correlation</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="shrinkage-in-linear-mixed-models.html"><a href="shrinkage-in-linear-mixed-models.html"><i class="fa fa-check"></i><b>3.6</b> Shrinkage in linear mixed models</a></li>
<li class="chapter" data-level="3.7" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>3.7</b> Summary</a></li>
<li class="chapter" data-level="3.8" data-path="sec-LMExercises.html"><a href="sec-LMExercises.html"><i class="fa fa-check"></i><b>3.8</b> Exercises</a><ul>
<li class="chapter" data-level="3.8.1" data-path="sec-LMExercises.html"><a href="sec-LMExercises.html#sec:LMExercisesPart1"><i class="fa fa-check"></i><b>3.8.1</b> By-subjects t-test</a></li>
<li class="chapter" data-level="3.8.2" data-path="sec-LMExercises.html"><a href="sec-LMExercises.html#sec:LMExercisesPart2"><i class="fa fa-check"></i><b>3.8.2</b> Fitting a linear mixed model</a></li>
<li class="chapter" data-level="3.8.3" data-path="sec-LMExercises.html"><a href="sec-LMExercises.html#sec:LMExercisesPart3"><i class="fa fa-check"></i><b>3.8.3</b> t-test vs.Â linear mixed model</a></li>
<li class="chapter" data-level="3.8.4" data-path="sec-LMExercises.html"><a href="sec-LMExercises.html#sec:LMExercisesPart4"><i class="fa fa-check"></i><b>3.8.4</b> Power calculation using power.t.test</a></li>
<li class="chapter" data-level="3.8.5" data-path="sec-LMExercises.html"><a href="sec-LMExercises.html#sec:LMExercisesPart5"><i class="fa fa-check"></i><b>3.8.5</b> Residuals</a></li>
<li class="chapter" data-level="3.8.6" data-path="sec-LMExercises.html"><a href="sec-LMExercises.html#sec:LMExercisesPart6"><i class="fa fa-check"></i><b>3.8.6</b> Understanding contrast coding</a></li>
<li class="chapter" data-level="3.8.7" data-path="sec-LMExercises.html"><a href="sec-LMExercises.html#sec:LMExercisesPart7"><i class="fa fa-check"></i><b>3.8.7</b> Understanding the fixed-effects output</a></li>
<li class="chapter" data-level="3.8.8" data-path="sec-LMExercises.html"><a href="sec-LMExercises.html#sec:LMExercisesPart8"><i class="fa fa-check"></i><b>3.8.8</b> Understanding the null hypothesis test</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="hypothesis-testing-using-the-likelihood-ratio-test.html"><a href="hypothesis-testing-using-the-likelihood-ratio-test.html"><i class="fa fa-check"></i><b>4</b> Hypothesis testing using the likelihood ratio test</a><ul>
<li class="chapter" data-level="4.1" data-path="the-likelihood-ratio-test-the-theory.html"><a href="the-likelihood-ratio-test-the-theory.html"><i class="fa fa-check"></i><b>4.1</b> The likelihood ratio test: The theory</a></li>
<li class="chapter" data-level="4.2" data-path="a-practical-example-using-simulated-data.html"><a href="a-practical-example-using-simulated-data.html"><i class="fa fa-check"></i><b>4.2</b> A practical example using simulated data</a></li>
<li class="chapter" data-level="4.3" data-path="a-real-life-example-the-english-relative-clause-data.html"><a href="a-real-life-example-the-english-relative-clause-data.html"><i class="fa fa-check"></i><b>4.3</b> A real-life example: The English relative clause data</a></li>
<li class="chapter" data-level="4.4" data-path="sec-HypTestExercises.html"><a href="sec-HypTestExercises.html"><i class="fa fa-check"></i><b>4.4</b> Exercises</a><ul>
<li class="chapter" data-level="4.4.1" data-path="sec-HypTestExercises.html"><a href="sec-HypTestExercises.html#sec:HypTestExercisesChinese"><i class="fa fa-check"></i><b>4.4.1</b> Chinese relative clauses</a></li>
<li class="chapter" data-level="4.4.2" data-path="sec-HypTestExercises.html"><a href="sec-HypTestExercises.html#sec:HypTestExerciseAgrmt"><i class="fa fa-check"></i><b>4.4.2</b> Agreement attraction in comprehension</a></li>
<li class="chapter" data-level="4.4.3" data-path="sec-HypTestExercises.html"><a href="sec-HypTestExercises.html#sec:HypTestExerciseGramCE"><i class="fa fa-check"></i><b>4.4.3</b> The grammaticality illusion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="using-simulation-to-understand-your-model.html"><a href="using-simulation-to-understand-your-model.html"><i class="fa fa-check"></i><b>5</b> Using simulation to understand your model</a><ul>
<li class="chapter" data-level="5.1" data-path="a-reminder-the-maximal-linear-mixed-model.html"><a href="a-reminder-the-maximal-linear-mixed-model.html"><i class="fa fa-check"></i><b>5.1</b> A reminder: The maximal linear mixed model</a></li>
<li class="chapter" data-level="5.2" data-path="obtain-estimates-from-a-previous-study.html"><a href="obtain-estimates-from-a-previous-study.html"><i class="fa fa-check"></i><b>5.2</b> Obtain estimates from a previous study</a></li>
<li class="chapter" data-level="5.3" data-path="decide-on-a-range-of-plausible-values-of-the-effect-size.html"><a href="decide-on-a-range-of-plausible-values-of-the-effect-size.html"><i class="fa fa-check"></i><b>5.3</b> Decide on a range of plausible values of the effect size</a></li>
<li class="chapter" data-level="5.4" data-path="extract-parameter-estimates.html"><a href="extract-parameter-estimates.html"><i class="fa fa-check"></i><b>5.4</b> Extract parameter estimates</a></li>
<li class="chapter" data-level="5.5" data-path="define-a-function-for-generating-data.html"><a href="define-a-function-for-generating-data.html"><i class="fa fa-check"></i><b>5.5</b> Define a function for generating data</a><ul>
<li class="chapter" data-level="5.5.1" data-path="define-a-function-for-generating-data.html"><a href="define-a-function-for-generating-data.html#generate-a-latin-square-design"><i class="fa fa-check"></i><b>5.5.1</b> Generate a Latin-square design</a></li>
<li class="chapter" data-level="5.5.2" data-path="define-a-function-for-generating-data.html"><a href="define-a-function-for-generating-data.html#generate-data-row-by-row"><i class="fa fa-check"></i><b>5.5.2</b> Generate data row-by-row</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="repeated-generation-of-data-to-compute-power.html"><a href="repeated-generation-of-data-to-compute-power.html"><i class="fa fa-check"></i><b>5.6</b> Repeated generation of data to compute power</a></li>
<li class="chapter" data-level="5.7" data-path="what-you-can-now-do.html"><a href="what-you-can-now-do.html"><i class="fa fa-check"></i><b>5.7</b> What you can now do</a></li>
<li class="chapter" data-level="5.8" data-path="sec-Simulationexercises.html"><a href="sec-Simulationexercises.html"><i class="fa fa-check"></i><b>5.8</b> Exercises</a><ul>
<li class="chapter" data-level="5.8.1" data-path="sec-Simulationexercises.html"><a href="sec-Simulationexercises.html#sec:SimulationexercisesPart1"><i class="fa fa-check"></i><b>5.8.1</b> Drawing a power curve given a range of effect sizes</a></li>
<li class="chapter" data-level="5.8.2" data-path="sec-Simulationexercises.html"><a href="sec-Simulationexercises.html#sec:SimulationexercisesPart2"><i class="fa fa-check"></i><b>5.8.2</b> Power and log-transformation</a></li>
<li class="chapter" data-level="5.8.3" data-path="sec-Simulationexercises.html"><a href="sec-Simulationexercises.html#sec:SimulationexercisesPart3"><i class="fa fa-check"></i><b>5.8.3</b> Evaluating models by generating simulated data</a></li>
<li class="chapter" data-level="5.8.4" data-path="sec-Simulationexercises.html"><a href="sec-Simulationexercises.html#sec:SimulationexercisesPart4"><i class="fa fa-check"></i><b>5.8.4</b> Using simulation to check parameter recovery</a></li>
<li class="chapter" data-level="5.8.5" data-path="sec-Simulationexercises.html"><a href="sec-Simulationexercises.html#sec:SimulationexercisesPart5"><i class="fa fa-check"></i><b>5.8.5</b> Sample size calculations using simulation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="important-distributions.html"><a href="important-distributions.html"><i class="fa fa-check"></i><b>6</b> Important distributions</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Linear Mixed Models in Linguistics and Psychology: A Comprehensive Introduction</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="define-a-function-for-generating-data" class="section level2">
<h2><span class="header-section-number">5.5</span> Define a function for generating data</h2>
<p>Next, we define a function that generates repeated measures data given the parameter estimates. The basic idea here is the following.</p>
<ul>
<li>First, create a data-frame that represents a Latin-square design.</li>
<li>Then, given the condition id, and the subject and item ids in each row of the data frame, generate data row-by-row.</li>
</ul>
<p>We explain these steps next.</p>
<div id="generate-a-latin-square-design" class="section level3">
<h3><span class="header-section-number">5.5.1</span> Generate a Latin-square design</h3>
<p>First, consider how one can create a Latin-square design. Suppose we have four items and four subjects. For such an experiment, we would create two groups, g1 and g2, with the following layout.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb300-1" data-line-number="1">nitem &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb300-2" data-line-number="2">nsubj &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb300-3" data-line-number="3"></a>
<a class="sourceLine" id="cb300-4" data-line-number="4">g1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">item =</span> <span class="dv">1</span><span class="op">:</span>nitem, <span class="dt">cond =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, </a>
<a class="sourceLine" id="cb300-5" data-line-number="5">  <span class="st">&quot;b&quot;</span>), nitem<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb300-6" data-line-number="6">g2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">item =</span> <span class="dv">1</span><span class="op">:</span>nitem, <span class="dt">cond =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;b&quot;</span>, </a>
<a class="sourceLine" id="cb300-7" data-line-number="7">  <span class="st">&quot;a&quot;</span>), nitem<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb300-8" data-line-number="8">g1</a></code></pre></div>
<pre><code>##   item cond
## 1    1    a
## 2    2    b
## 3    3    a
## 4    4    b</code></pre>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb302-1" data-line-number="1">g2</a></code></pre></div>
<pre><code>##   item cond
## 1    1    b
## 2    2    a
## 3    3    b
## 4    4    a</code></pre>
<p>Half the total number of subjects will be assigned to group 1 and half to group 2:</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb304-1" data-line-number="1"><span class="co">## assemble data frame:</span></a>
<a class="sourceLine" id="cb304-2" data-line-number="2">gp1 &lt;-<span class="st"> </span>g1[<span class="kw">rep</span>(<span class="kw">seq_len</span>(<span class="kw">nrow</span>(g1)), nsubj<span class="op">/</span><span class="dv">2</span>), ]</a>
<a class="sourceLine" id="cb304-3" data-line-number="3">gp2 &lt;-<span class="st"> </span>g2[<span class="kw">rep</span>(<span class="kw">seq_len</span>(<span class="kw">nrow</span>(g2)), nsubj<span class="op">/</span><span class="dv">2</span>), ]</a>
<a class="sourceLine" id="cb304-4" data-line-number="4"></a>
<a class="sourceLine" id="cb304-5" data-line-number="5">simdat &lt;-<span class="st"> </span><span class="kw">rbind</span>(gp1, gp2)</a>
<a class="sourceLine" id="cb304-6" data-line-number="6"></a>
<a class="sourceLine" id="cb304-7" data-line-number="7"><span class="co">## add subject column:</span></a>
<a class="sourceLine" id="cb304-8" data-line-number="8">simdat<span class="op">$</span>subj &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>nsubj, <span class="dt">each =</span> nitem)</a></code></pre></div>
<p>Finally, the contrast coding for each row in the data-frame is set up:</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb305-1" data-line-number="1"><span class="co">## add contrast coding:</span></a>
<a class="sourceLine" id="cb305-2" data-line-number="2">simdat<span class="op">$</span>so &lt;-<span class="st"> </span><span class="kw">ifelse</span>(simdat<span class="op">$</span>cond <span class="op">==</span><span class="st"> &quot;a&quot;</span>, <span class="dv">-1</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a></code></pre></div>
</div>
<div id="generate-data-row-by-row" class="section level3">
<h3><span class="header-section-number">5.5.2</span> Generate data row-by-row</h3>
<p>Then, we proceed row-by-row in this data frame, and generate data for each subject, item, and condition. For example, the first row of our simulated data-set has subject id:</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb306-1" data-line-number="1">simdat[<span class="dv">1</span>, ]<span class="op">$</span>subj</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>Similarly, the first row has item id:</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb308-1" data-line-number="1">simdat[<span class="dv">1</span>, ]<span class="op">$</span>item</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>The first rowâs condition coding is:</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb310-1" data-line-number="1">simdat[<span class="dv">1</span>, ]<span class="op">$</span>so</a></code></pre></div>
<pre><code>## [1] -0.5</code></pre>
<p>These three pieces of information are what we need to generate data for the first row. Recall that the model for subject <span class="math inline">\(i\)</span> and item <span class="math inline">\(j\)</span> in condition <code>so</code> is</p>
<p><span class="math display">\[\begin{equation}
\beta_0 + u_{0i} + w_{0j} + (\beta+1 + u_{1i} + w_{1j})\times so + \varepsilon \hbox{ where } \varepsilon \sim N(0,\sigma)
\end{equation}\]</span></p>
<p>The terms u0, w0, and u1, w1, which are the adjustments to the intercepts and slopes by subject and item, are stored in two matrices that are generated randomly each time that we simulate new subjects/items. Recall from chapter 1 how bivariate data are generated. The intercept and slope adjustments will be generated using the <code>mvrnorm</code> function in the MASS library. For example, given the variance covariance matrix for subjects <code>Sigma_u</code> that we created above, the subject random effects (intercept and slope adjustments) for 10 subjects can be generated in a matrix as follows:</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb312-1" data-line-number="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb312-2" data-line-number="2">u &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">mu =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">Sigma =</span> Sigma_u)</a>
<a class="sourceLine" id="cb312-3" data-line-number="3">u</a></code></pre></div>
<pre><code>##       (Intercept)       so
##  [1,]      0.1059 -0.06177
##  [2,]      0.4790 -0.13362
##  [3,]      0.3538  0.26910
##  [4,]      0.1804  0.22173
##  [5,]     -0.1610  0.34222
##  [6,]      0.2322  0.08877
##  [7,]      0.3389  0.16131
##  [8,]     -0.2254  0.12916
##  [9,]     -0.1795 -0.20251
## [10,]      0.6060  0.40070</code></pre>
<p>Each row in this matrix is the intercept and slope adjustment for a subject; the row number indexes the subject id. For example, subject 1âs intercept adjustment is:</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb314-1" data-line-number="1">u[<span class="dv">1</span>, <span class="dv">1</span>]</a></code></pre></div>
<pre><code>## (Intercept) 
##      0.1059</code></pre>
<p>Subject 1âs slope adjustment is:</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb316-1" data-line-number="1">u[<span class="dv">1</span>, <span class="dv">2</span>]</a></code></pre></div>
<pre><code>##       so 
## -0.06177</code></pre>
<p>Analogously to the subject random effects matrix, a matrix for items random effects is also generated. As an example, we generate simulated random effects for 10 items:</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb318-1" data-line-number="1">w &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">mu =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">Sigma =</span> Sigma_w)</a>
<a class="sourceLine" id="cb318-2" data-line-number="2">w</a></code></pre></div>
<pre><code>##            [,1]       [,2]
##  [1,] -0.028129 -0.0476951
##  [2,]  0.019630  0.1601535
##  [3,]  0.060869 -0.0519072
##  [4,] -0.057216 -0.0980981
##  [5,]  0.025503  0.1211837
##  [6,]  0.047698 -0.0810234
##  [7,]  0.014671  0.0206600
##  [8,] -0.005208 -0.0001712
##  [9,]  0.097832  0.0729380
## [10,] -0.013452 -0.0386293</code></pre>
<p>Now, to generate simulated data for subject 1 and item 1 for object relatives, we simply need to run this line of code:</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb320-1" data-line-number="1"><span class="kw">rlnorm</span>(<span class="dv">1</span>, beta[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>u[<span class="dv">1</span>, <span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>w[<span class="dv">1</span>, <span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>(beta[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb320-2" data-line-number="2"><span class="st">  </span>u[<span class="dv">1</span>, <span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>w[<span class="dv">1</span>, <span class="dv">2</span>]) <span class="op">*</span><span class="st"> </span>(<span class="fl">0.5</span>), sigma_e)</a></code></pre></div>
<pre><code>## [1] 398.3</code></pre>
<p>For subject 2, all that would change is the subject id: instead of <code>u[1,1]</code>, and <code>u[1,2]</code> we would write <code>u[2,1]</code> and <code>u[2,2]</code>. The for-loop below works through the <code>simdat</code> data-frame row by row, looks up the subject id, the item id for that row, and the condition coding for that row, and fills in the simulated reading time using the above code. This is how the simulated data are generated.</p>
<p>Here is the complete function for generating simulated data. It uses all the bits of code we discussed above.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb322-1" data-line-number="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb322-2" data-line-number="2"><span class="co">## assumes that no. of subjects and </span></a>
<a class="sourceLine" id="cb322-3" data-line-number="3"><span class="co">## no. of items is divisible by 2.</span></a>
<a class="sourceLine" id="cb322-4" data-line-number="4">gen_sim_lnorm2&lt;-<span class="cf">function</span>(<span class="dt">nitem=</span><span class="dv">16</span>,</a>
<a class="sourceLine" id="cb322-5" data-line-number="5">                         <span class="dt">nsubj=</span><span class="dv">42</span>,</a>
<a class="sourceLine" id="cb322-6" data-line-number="6">                         <span class="dt">beta=</span><span class="ot">NULL</span>,</a>
<a class="sourceLine" id="cb322-7" data-line-number="7">                         <span class="dt">Sigma_u=</span><span class="ot">NULL</span>, <span class="co"># subject vcov matrix</span></a>
<a class="sourceLine" id="cb322-8" data-line-number="8">                         <span class="dt">Sigma_w=</span><span class="ot">NULL</span>, <span class="co"># item vcov matrix</span></a>
<a class="sourceLine" id="cb322-9" data-line-number="9">                         <span class="dt">sigma_e=</span><span class="ot">NULL</span>){</a>
<a class="sourceLine" id="cb322-10" data-line-number="10">  <span class="co">## prepare data frame for a two-condition latin square:</span></a>
<a class="sourceLine" id="cb322-11" data-line-number="11">  g1&lt;-<span class="kw">data.frame</span>(<span class="dt">item=</span><span class="dv">1</span><span class="op">:</span>nitem,</a>
<a class="sourceLine" id="cb322-12" data-line-number="12">                 <span class="dt">cond=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>),nitem<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb322-13" data-line-number="13">  g2&lt;-<span class="kw">data.frame</span>(<span class="dt">item=</span><span class="dv">1</span><span class="op">:</span>nitem,</a>
<a class="sourceLine" id="cb322-14" data-line-number="14">                 <span class="dt">cond=</span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;b&quot;</span>,<span class="st">&quot;a&quot;</span>),nitem<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb322-15" data-line-number="15"></a>
<a class="sourceLine" id="cb322-16" data-line-number="16">  </a>
<a class="sourceLine" id="cb322-17" data-line-number="17">  <span class="co">## assemble data frame:</span></a>
<a class="sourceLine" id="cb322-18" data-line-number="18">  gp1&lt;-g1[<span class="kw">rep</span>(<span class="kw">seq_len</span>(<span class="kw">nrow</span>(g1)), </a>
<a class="sourceLine" id="cb322-19" data-line-number="19">              nsubj<span class="op">/</span><span class="dv">2</span>),]</a>
<a class="sourceLine" id="cb322-20" data-line-number="20">  gp2&lt;-g2[<span class="kw">rep</span>(<span class="kw">seq_len</span>(<span class="kw">nrow</span>(g2)), </a>
<a class="sourceLine" id="cb322-21" data-line-number="21">              nsubj<span class="op">/</span><span class="dv">2</span>),]</a>
<a class="sourceLine" id="cb322-22" data-line-number="22">  </a>
<a class="sourceLine" id="cb322-23" data-line-number="23">  simdat&lt;-<span class="kw">rbind</span>(gp1,gp2)</a>
<a class="sourceLine" id="cb322-24" data-line-number="24">  </a>
<a class="sourceLine" id="cb322-25" data-line-number="25">  <span class="co">## add subject column:</span></a>
<a class="sourceLine" id="cb322-26" data-line-number="26">  simdat<span class="op">$</span>subj&lt;-<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>nsubj,<span class="dt">each=</span>nitem)</a>
<a class="sourceLine" id="cb322-27" data-line-number="27">  </a>
<a class="sourceLine" id="cb322-28" data-line-number="28">  <span class="co">## add contrast coding:</span></a>
<a class="sourceLine" id="cb322-29" data-line-number="29">  simdat<span class="op">$</span>so&lt;-<span class="kw">ifelse</span>(simdat<span class="op">$</span>cond<span class="op">==</span><span class="st">&quot;a&quot;</span>,<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb322-30" data-line-number="30"></a>
<a class="sourceLine" id="cb322-31" data-line-number="31">  <span class="co">## subject random effects:</span></a>
<a class="sourceLine" id="cb322-32" data-line-number="32">  u&lt;-<span class="kw">mvrnorm</span>(<span class="dt">n=</span><span class="kw">length</span>(<span class="kw">unique</span>(simdat<span class="op">$</span>subj)),</a>
<a class="sourceLine" id="cb322-33" data-line-number="33">             <span class="dt">mu=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">Sigma=</span>Sigma_u)</a>
<a class="sourceLine" id="cb322-34" data-line-number="34">  </a>
<a class="sourceLine" id="cb322-35" data-line-number="35">  <span class="co">## item random effects</span></a>
<a class="sourceLine" id="cb322-36" data-line-number="36">  w&lt;-<span class="kw">mvrnorm</span>(<span class="dt">n=</span><span class="kw">length</span>(<span class="kw">unique</span>(simdat<span class="op">$</span>item)),</a>
<a class="sourceLine" id="cb322-37" data-line-number="37">             <span class="dt">mu=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),<span class="dt">Sigma=</span>Sigma_w)</a>
<a class="sourceLine" id="cb322-38" data-line-number="38"></a>
<a class="sourceLine" id="cb322-39" data-line-number="39">  <span class="co">## generate data row by row:  </span></a>
<a class="sourceLine" id="cb322-40" data-line-number="40">  N&lt;-<span class="kw">dim</span>(simdat)[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb322-41" data-line-number="41">  rt&lt;-<span class="kw">rep</span>(<span class="ot">NA</span>,N)</a>
<a class="sourceLine" id="cb322-42" data-line-number="42">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb322-43" data-line-number="43">    rt[i] &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(<span class="dv">1</span>,beta[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb322-44" data-line-number="44"><span class="st">                      </span>u[simdat[i,]<span class="op">$</span>subj,<span class="dv">1</span>] <span class="op">+</span></a>
<a class="sourceLine" id="cb322-45" data-line-number="45"><span class="st">                      </span>w[simdat[i,]<span class="op">$</span>item,<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb322-46" data-line-number="46"><span class="st">                      </span>(beta[<span class="dv">2</span>]<span class="op">+</span>u[simdat[i,]<span class="op">$</span>subj,<span class="dv">2</span>]<span class="op">+</span></a>
<a class="sourceLine" id="cb322-47" data-line-number="47"><span class="st">                         </span>w[simdat[i,]<span class="op">$</span>item,<span class="dv">2</span>])<span class="op">*</span>simdat<span class="op">$</span>so[i],</a>
<a class="sourceLine" id="cb322-48" data-line-number="48">                   sigma_e) </a>
<a class="sourceLine" id="cb322-49" data-line-number="49">  }   </a>
<a class="sourceLine" id="cb322-50" data-line-number="50">  simdat<span class="op">$</span>rt&lt;-rt</a>
<a class="sourceLine" id="cb322-51" data-line-number="51">  simdat<span class="op">$</span>subj&lt;-<span class="kw">factor</span>(simdat<span class="op">$</span>subj)</a>
<a class="sourceLine" id="cb322-52" data-line-number="52">  simdat<span class="op">$</span>item&lt;-<span class="kw">factor</span>(simdat<span class="op">$</span>item)</a>
<a class="sourceLine" id="cb322-53" data-line-number="53">  simdat}</a></code></pre></div>
<p>Letâs generate some simulated data and check what the data look like:</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb323-1" data-line-number="1">dat &lt;-<span class="st"> </span><span class="kw">gen_sim_lnorm2</span>(<span class="dt">nitem =</span> <span class="dv">16</span>, <span class="dt">nsubj =</span> <span class="dv">42</span>, <span class="dt">beta =</span> beta, </a>
<a class="sourceLine" id="cb323-2" data-line-number="2">  <span class="dt">Sigma_u =</span> Sigma_u, <span class="dt">Sigma_w =</span> Sigma_w, <span class="dt">sigma_e =</span> sigma_e)</a></code></pre></div>
<p>The data have the expected structure:</p>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb324-1" data-line-number="1"><span class="co">## fully crossed subjects and items:</span></a>
<a class="sourceLine" id="cb324-2" data-line-number="2"><span class="kw">head</span>(<span class="kw">t</span>(<span class="kw">xtabs</span>(<span class="op">~</span>subj <span class="op">+</span><span class="st"> </span>item, dat)))</a></code></pre></div>
<pre><code>##     subj
## item 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19
##    1 1 1 1 1 1 1 1 1 1  1  1  1  1  1  1  1  1  1  1
##    2 1 1 1 1 1 1 1 1 1  1  1  1  1  1  1  1  1  1  1
##    3 1 1 1 1 1 1 1 1 1  1  1  1  1  1  1  1  1  1  1
##    4 1 1 1 1 1 1 1 1 1  1  1  1  1  1  1  1  1  1  1
##    5 1 1 1 1 1 1 1 1 1  1  1  1  1  1  1  1  1  1  1
##    6 1 1 1 1 1 1 1 1 1  1  1  1  1  1  1  1  1  1  1
##     subj
## item 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35
##    1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
##    2  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
##    3  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
##    4  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
##    5  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
##    6  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1
##     subj
## item 36 37 38 39 40 41 42
##    1  1  1  1  1  1  1  1
##    2  1  1  1  1  1  1  1
##    3  1  1  1  1  1  1  1
##    4  1  1  1  1  1  1  1
##    5  1  1  1  1  1  1  1
##    6  1  1  1  1  1  1  1</code></pre>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb326-1" data-line-number="1"><span class="co">## 8 measurements per condition:</span></a>
<a class="sourceLine" id="cb326-2" data-line-number="2"><span class="kw">head</span>(<span class="kw">t</span>(<span class="kw">xtabs</span>(<span class="op">~</span>subj <span class="op">+</span><span class="st"> </span>cond, dat)))</a></code></pre></div>
<pre><code>##     subj
## cond 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19
##    a 8 8 8 8 8 8 8 8 8  8  8  8  8  8  8  8  8  8  8
##    b 8 8 8 8 8 8 8 8 8  8  8  8  8  8  8  8  8  8  8
##     subj
## cond 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35
##    a  8  8  8  8  8  8  8  8  8  8  8  8  8  8  8  8
##    b  8  8  8  8  8  8  8  8  8  8  8  8  8  8  8  8
##     subj
## cond 36 37 38 39 40 41 42
##    a  8  8  8  8  8  8  8
##    b  8  8  8  8  8  8  8</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb328-1" data-line-number="1"><span class="co">## contrast coding check:</span></a>
<a class="sourceLine" id="cb328-2" data-line-number="2"><span class="kw">xtabs</span>(<span class="op">~</span>so <span class="op">+</span><span class="st"> </span>cond, dat)</a></code></pre></div>
<pre><code>##       cond
## so       a   b
##   -0.5 336   0
##   0.5    0 336</code></pre>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb330-1" data-line-number="1"><span class="co">## condition b is slower than a:</span></a>
<a class="sourceLine" id="cb330-2" data-line-number="2"><span class="kw">round</span>(<span class="kw">with</span>(dat, <span class="kw">tapply</span>(rt, cond, mean)))</a></code></pre></div>
<pre><code>##   a   b 
## 356 431</code></pre>
<p>Everything checks out.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="extract-parameter-estimates.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="repeated-generation-of-data-to-compute-power.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown/edit/master/inst/examples/05-Simulation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Freq_CogSci.pdf", "Freq_CogSci.epub", "Freq_CogSci.mobi"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
